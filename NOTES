NOTES (new install)
~~~~~~~~~~~~~~~~

* TODO Test full queues build + install, incl. usage

* TODO Try more complex eggs

* TODO .egg files for all C5 eggs

* TODO chicken-do: delete target file if build fails
    - needs to fork subprocess.
    - better would be to use temporary for output and then rename.
        - but then would have to replace occurrence of target in command arguments.

* TODO Separation of d/l step possible?
    - required to check downloaded content.

* TODO Rebase on upstream at some stage

* Complete egg-info compilation
** TODO What should the default optimization options be?
    - also for compiled import libraries.
    - respect DEBUGBUILD?

* TODO Option for not fetching/installing dependencies
    - proposed by wasamasa.
    - does this make sense?

* TODO Support for generating + installing extra files
    - types, inline-files

* Implement minimal "chicken-install"
** Basic functionality
*** TODO just download eggs (recursively) and build/install.
*** TODO Repository init (cross-aware)
    - old-chicken-install.scm://+default-repository-files+/
*** TODO Update modules DB
*** TODO print repository
*** TODO retrieve egg
*** TODO Also support recursive retrieve
*** TODO Comment all toplevel procedures
*** TODO Add usage information

* TODO repository-path
    - allow multiple locations?
    - perhaps: CHICKEN_INSTALL_REPOSITORY (defaults to install-prefix) as
      installation target.

* Egg Installation
** TODO unlink .so's before overwriting them.

* Issues
** Link-options are passed directly to csc
    - is this right?

* Suggestion by florz: sign eggs and decode using NaCl
    - https://tweetnacl.cr.yp.to/software.html

* Setup features
** TODO Keep binaries + intermediate files ("-k")
** TODO "-feature" + "-no-feature"
** TODO Hack for OSX SIP?
** TODO reinstall, no-install?
** TODO Request by Jon Foerch: allow *.egg in specific subdirectory ("chicken"?)

* TODO "build-dependencies" 
    - toplevel deps that are needed during build, override "dependencies", if given.
    - or is the intent differently? Ask moritz.

* Download/build directories
** TODO handle egg-files given on command-line

* TODO Fix egg tests in "tests" directory

* TODO Check what cmdline options to retain
** TODO Option for explicitly generating Windows/UNIX build/install scripts
    - i.e. selecting target platform.

* Things to resolve
** setup-info files
*** one for the whole egg (use "components" to find associated parts).
*** TODO Fix "extension-information"
*** TODO syntax-only extensions 
    - i.e. matchable (is it?)

* TODO Drop CHICKEN_PREFIX
    - chicken-prefix

* Build/install scripts
** TODO Use "-setup-mode" when invoking csc during build
** must be fully sh(1) compatible
    - http://people.fas.harvard.edu/~lib113/reference/unix/portable_scripting.html
    - https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cmd.mspx?mfr=true
** TODO Test "chicken-do" and port to Windows
    - ideally, use execvp/CreateProcess
        - http://www.cplusplus.com/forum/windows/3398/ and
          http://www.cplusplus.com/forum/beginner/1988/3/#msg14102
** TODO Consider making this powerful enough to build chicken
    - needs support for object-files (C or Scheme) and building libraries.
** TODO Handle case where program and extension in egg have same name
    - e.g. "hyde" in hyde egg.
    - can we ignore this? if source files have different names, just compiling exe/so directly should
      work.

* TODO "dependencies" has 2 meanings, depending on nesting level in egg info

* TODO Do we have to cleanup after building eggs?

* Install scripts
** Allow overriding PREFIX?
** Use install(1) ?

* TODO Integrate running tests into build-script

* Tools
** TODO chicken-install
** TODO chicken-uninstall
    - use "installed-files" egg-info prop.
** TODO chicken-status
    - option to list cached eggs (+ version)
    - option to purge cache
    - filter egg-info and list components.
    - optionally list installed files instead.

* TODO Copyright headers
    - chicken-do.c  egg-*.scm

* TODO Documentation
    - document CHICKEN_EGG_CACHE
    - remove old and obsolete stuff  dropped options, etc.)
    - update manual
    - chicken-do (manpage)
    - update egg-tutorial on wiki

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

cm chicken-do && cp chicken-do bin
cm chicken-install 
chicken-config.h  chicken-do.c  config.mk  old-chicken-install.scm  rules.make
git gui   win  queues
/home/felix/.chicken-install.cache/
env LD_LIBRARY_PATH=/home/felix/chicken/chicken-5-new-egg-install ../chicken-install -defaults ../setup.defaults -n

chicken-install.scm  setup-api.scm
new-install.scm  egg-compile.scm  egg-environment.scm  egg-download.scm
gg setup-info

